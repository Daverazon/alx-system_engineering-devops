# Configure ufw so that it blocks all incoming traffic, except the following TCP ports: 22 (SSH), 443 (HTTPS SSL), 80 (HTTP)
sudo apt-get install -y ufw
sudo ufw deny incoming
sudo ufw allow outgoing
sudo ufw allow 22/tcp # ssh port
sudo ufw allow 80/tcp # http port
sudo ufw allow 443/tcp # https port
sudo ufw enable

# Enable IP forwarding
sed -i '/^#net.ipv4.ip_forward=1/s/^#//' /etc/ufw/sysctl.conf
sudo sysctl -p /etc/ufw/sysctl.conf

# Add iptables rule for port forwarding
sudo iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 8080 -j REDIRECT --to-port 80

# Allow incoming traffic on port 8080
sudo ufw allow 8080/tcp
