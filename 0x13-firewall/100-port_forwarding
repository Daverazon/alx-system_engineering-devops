# Configure ufw so that it blocks all incoming traffic, except the following TCP ports: 22 (SSH), 443 (HTTPS SSL), 80 (HTTP)
sudo apt-get install -y ufw
sudo ufw deny incoming
sudo ufw allow outgoing
sudo ufw allow 22/tcp # ssh port
sudo ufw allow 80/tcp # http port
sudo ufw allow 443/tcp # https port
sudo ufw enable

## Redirect TCP traffic from port 8080 to port 80
sudo iptables -t nat -A PREROUTING -p tcp --dport 8080 -j REDIRECT --to-port 80

# Ensure the directory exists for saving iptables rules (Debian/Ubuntu)
sudo mkdir -p /etc/iptables

## Save the iptables rule so it persists across reboots
## For Debian/Ubuntu
sudo iptables-save | sudo tee /etc/iptables/rules.v4 > /dev/null

## For RHEL/CentOS
## sudo iptables-save | sudo tee /etc/sysconfig/iptables > /dev/null
